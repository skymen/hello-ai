// UI Components for the AI News Summarizer

// Utility function to create message containers
function createMessageContainer(isUser = false) {
  const chatArea = document.getElementById("chatArea");
  const messageDiv = document.createElement("div");
  messageDiv.className = `message ${isUser ? "user-message" : "ai-message"}`;

  if (isUser) {
    const messageContent = document.createElement("div");
    messageContent.className = "message-content";

    const avatar = document.createElement("div");
    avatar.className = "avatar user-avatar";
    avatar.textContent = "You";

    messageDiv.appendChild(messageContent);
    messageDiv.appendChild(avatar);
  } else {
    const avatar = document.createElement("div");
    avatar.className = "avatar ai-avatar";
    avatar.innerHTML = `
      <svg class="face-normal" width="407" height="437" viewBox="0 0 407 437" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M96.4 0.8268C51.4667 8.56013 14.9333 41.6268 3.06667 85.0935C0 96.1601 0 96.5601 0 188.827C0 274.56 0.133333 282.16 2.4 290.027C12.8 326.427 38.5333 354.027 75.0667 368.027L84.6667 371.76V390.96C84.6667 414.827 86 420.693 93.2 428.16C102 437.36 112.8 438.827 124.8 432.827C127.467 431.36 138.8 421.76 150 411.227C161.2 400.693 174.267 388.56 179.067 384.16L187.867 376.16L248.533 375.36C318.267 374.56 319.6 374.293 344 362.293C372.8 348.027 393.467 323.76 402.933 293.493L406.667 281.493V188.827C406.667 96.9601 406.667 96.0268 403.733 85.8935C398 66.1601 390.267 52.2935 376.933 37.8935C362.4 22.2935 340.8 9.36013 318.667 3.2268C308.133 0.293467 307.2 0.160133 205.333 0.0268002C148.933 -0.106533 99.8667 0.293467 96.4 0.8268ZM308 33.2268C313.2 34.4268 322.4 37.8935 328.667 40.9601C344 48.5601 359.333 63.6268 366.533 78.1601C375.067 95.6268 375.333 99.2268 375.333 190.027C375.333 266.427 375.2 271.627 372.667 281.36C368.8 296.427 362.933 306.693 351.333 318.293C340.933 328.827 331.6 334.96 318.4 339.76C310.933 342.56 308.267 342.693 246 343.493C165.333 344.293 176.533 340.827 139.2 377.627C127.867 388.96 118 397.76 117.6 397.227C117.067 396.827 116.667 385.76 116.667 372.827C116.667 356.16 116.133 348.693 115.067 347.093C114 345.76 108.267 343.893 100 342.293C80.6667 338.293 69.2 332.293 55.8667 318.96C47.8667 310.96 43.8667 305.627 40.1333 298.16C31.3333 279.893 31.2 278.693 31.6 182.96C32 97.6268 32 97.4935 35.0667 88.8268C40 75.2268 47.7333 63.3601 57.8667 53.8935C71.7333 40.9601 86.6667 34.0268 106 31.3601C110 30.8268 155.067 30.5601 206 30.6935C286.667 30.9601 299.867 31.3601 308 33.2268Z" fill="currentColor"/>
        <path d="M122.667 146.027C104.133 154.56 100.4 178.027 115.333 192.56C124.933 201.76 142.4 201.76 152.4 192.427C164 181.627 163.333 158.827 151.2 149.893C142.133 143.227 131.867 141.76 122.667 146.027Z" fill="currentColor"/>
        <path d="M275.333 145.626C264.933 150.159 259.333 159.093 259.333 171.493C259.333 193.493 280.4 206.159 300.133 195.893C310.4 190.559 316.533 174.559 312.667 162.826C307.733 147.893 289.6 139.493 275.333 145.626Z" fill="currentColor"/>
        <path d="M157.867 225.494C149.067 230.294 150.267 239.627 161.467 251.494C174.267 265.227 189.6 271.494 210 271.494C229.733 271.494 244.133 266.027 257.067 253.494C269.467 241.494 271.6 234.161 264.8 227.361C258.533 221.094 254.267 222.027 244 231.494C233.2 241.627 225.733 244.961 212.667 245.761C198.533 246.694 189.733 243.227 177.733 232.027C168.133 222.961 164.667 221.761 157.867 225.494Z" fill="currentColor"/>
      </svg>
      <svg class="face-thinking" width="428" height="471" viewBox="0 0 428 471" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M92.4 2.09958C45.8667 10.4996 9.6 45.5662 2 89.2996C0.4 98.3663 0 117.166 0 188.766V277.033L3.33333 290.1C8.26667 309.833 20.9333 331.966 34.2667 344.233C50.4 359.033 67.4667 368.1 88.5333 372.766C91.8667 373.433 92.1333 373.966 91.3333 377.166C90.8 379.166 90.1333 387.7 89.7333 396.1C89.2 409.433 89.4667 412.5 92 419.966C104.4 456.766 145.067 477.7 186.8 468.9C207.733 464.366 228 449.166 236.933 431.166C241.467 422.1 242 419.833 242.4 408.233L242.933 395.433L250.533 385.566C254.667 380.1 258.4 375.033 258.933 374.233C259.6 373.166 271.067 372.766 295.6 372.766C337.333 372.766 343.467 371.7 364.667 361.433C393.867 347.3 414.267 323.166 424.133 290.766C427.2 280.766 427.2 280.366 427.733 187.966C428.133 87.4329 428 85.8329 420.933 68.0996C415.467 54.6329 409.2 45.2996 398 34.0996C380.267 16.2329 361.467 6.23291 337.733 2.09958C322.133 -0.700424 107.467 -0.700424 92.4 2.09958ZM337.333 34.6329C362.133 41.4329 384.133 62.4996 392.133 86.8996L395.333 96.7663V185.433V274.1L391.467 285.966C382.667 312.766 360.4 333.033 332.533 339.566C324.933 341.3 316.4 341.566 282 341.166L264 340.9C264 340.9 264.5 334.9 254.5 326.5C244.5 318.1 214.133 330.233 201.067 333.566C185.733 337.566 185.333 337.033 184 319.566C182.8 304.766 179.6 297.566 171.333 291.833C160.4 284.1 138.933 284.366 128.133 292.1C120 297.966 116.8 303.433 110.667 321.833C107.467 331.166 104.267 339.7 103.467 340.766C102.133 342.5 100.8 342.5 93.2 340.9C77.4667 337.566 59.7333 326.233 49.7333 313.3C42.1333 303.433 35.0667 287.833 33.3333 277.433C32.5333 272.233 32 235.966 32 185.433C32 114.766 32.2667 100.766 34 94.0996C42 63.2996 66.6667 39.5662 96.4 34.0996C109.733 31.5662 328.267 32.0996 337.333 34.6329ZM156.533 311.166C158.933 314.366 159.467 317.433 160 330.766C160.8 349.033 162.133 352.1 172 357.033C179.2 360.766 188.8 361.033 200.8 357.833C209.2 355.566 230.567 342.259 239 345C244.333 346.733 246 351.366 242.933 357.033C239.867 362.7 237.6 366.366 237.6 366.366L230 374.9C218.4 387.833 217.333 389.966 217.333 401.433C217.2 417.833 212.533 426.633 199.733 435.166C189.067 442.1 179.333 444.633 164.8 443.7C149.067 442.9 139.6 439.3 130.133 430.633C121.867 423.166 118 415.966 115.867 404.9C114.133 395.033 115.333 389.033 126.267 355.433C138.4 318.1 140.133 313.7 143.067 309.966C146.533 305.433 152.667 305.966 156.533 311.166Z" fill="currentColor"/>
        <path d="M336.667 141.166C333.733 142.499 319.333 149.566 304.667 157.033C281.6 168.633 277.6 171.166 275.467 175.033C272.667 180.233 273.2 184.766 276.933 189.166C280.4 193.033 335.6 221.699 341.333 222.366C352 223.833 358.4 210.366 350.933 202.366C349.333 200.633 339.867 195.299 330 190.633C320.133 185.966 312.133 181.833 312 181.433C312 181.033 320.133 176.633 330 171.699C339.867 166.766 349.733 161.166 352 159.299C357.6 154.499 357.467 149.299 351.467 143.299C346.4 138.233 344.267 137.966 336.667 141.166Z" fill="currentColor"/>
        <path d="M94.5333 143.967C90.2666 148.233 89.6 153.3 92.5333 158.633C93.7333 160.9 101.067 165.3 114.8 172.1C126 177.7 135.333 182.9 135.6 183.567C135.867 184.233 127.6 189.033 117.2 194.1C98 203.567 93.3333 207.3 93.3333 213.033C93.3333 217.167 96.6666 223.567 99.3333 224.633C106 227.167 111.333 225.3 141.867 209.433C166.133 196.9 173.333 192.5 175.2 189.433C178 184.5 177.2 178.9 172.933 175.033C168 170.5 106.533 140.1 102.267 140.1C99.8666 140.1 97.0666 141.433 94.5333 143.967Z" fill="currentColor"/>
        <path d="M212.667 194.634C195.867 198.767 185.867 215.034 195.467 222.634C200.4 226.5 202.4 226.1 207.2 220.634C211.867 215.3 219.2 213.434 225.733 215.967C230.8 217.967 230.267 221.3 224 227.434C213.867 237.434 213.867 248.367 224.133 255.567C231.333 260.5 232.667 263.167 229.333 266.1C226.533 268.634 219.2 269.3 211.6 267.567C206.667 266.5 206.667 266.5 203.867 272.634C202.4 276.1 201.333 279.834 201.6 281.034C202.8 287.034 221.333 291.3 232.8 288.234C247.867 284.1 258.133 269.167 254.667 256.234C253.333 251.434 245.6 242.634 241.333 241.167C240.267 240.9 242.267 237.967 246.533 233.434C258.4 221.167 259.067 210.767 248.533 201.567C240.267 194.367 225.733 191.567 212.667 194.634Z" fill="currentColor"/>
      </svg>
      <svg class="face-done" width="461" height="724" viewBox="0 0 461 724" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M321.741 3.74734L317.906 7.28783V31.7762V56.412L322.331 60.8376C326.314 64.6731 327.642 65.2632 332.362 64.5256C335.608 63.9355 339.148 62.0178 341.214 59.805C344.312 56.117 344.459 54.6418 344.459 32.3662V8.61551L340.181 4.33742C334.575 -1.26834 327.347 -1.41586 321.741 3.74734Z" fill="currentColor"/>
        <path d="M206.381 56.1159C201.66 58.0337 198.414 63.492 198.414 69.2452C198.414 73.6708 200.332 76.1787 213.757 89.898C228.509 104.65 229.541 105.535 235.294 105.535C243.261 105.535 248.571 99.9294 248.571 91.8158C248.571 86.9476 247.096 85.0299 232.639 70.5729C216.264 54.1982 214.052 53.018 206.381 56.1159Z" fill="currentColor"/>
        <path d="M441.085 57.445C438.724 58.9202 430.906 66.1487 423.825 73.3772C411.876 85.6214 410.843 87.2441 410.843 92.5548C410.843 99.4882 415.121 104.209 422.35 105.684C428.546 106.864 431.939 104.651 448.166 88.4242C460.115 76.3276 461 74.9999 461 69.3942C461 64.526 460.115 62.3132 456.722 58.9202C451.706 53.9045 447.281 53.462 441.085 57.445Z" fill="currentColor"/>
        <path d="M317.168 89.4569C315.545 89.752 310.53 90.7846 306.104 91.6697C291.352 94.6201 274.387 103.914 262.586 115.716C243.408 134.893 233.819 157.759 233.819 184.312C233.819 200.835 236.327 211.751 243.261 225.913L248.276 236.092H167.14C77.448 236.092 77.5955 236.092 57.5328 245.681C38.7978 254.679 19.9152 273.119 10.6214 291.412C8.55616 295.542 5.31072 303.804 3.39296 309.852L0 320.916V416.804V512.692L3.98304 525.231C10.9165 546.326 20.6528 561.226 37.4701 575.83C48.3866 585.272 69.3344 595.598 83.0538 598.106C88.9546 599.286 94.1178 600.466 94.4128 600.761C94.7079 601.056 94.1178 604.892 92.9376 609.318C87.9219 627.905 88.9546 655.049 95.1504 671.719C104.002 695.027 125.392 713.762 151.208 720.843C164.19 724.383 191.038 724.383 204.315 720.843C227.476 714.647 244.736 700.485 250.046 683.52C251.964 677.177 252.702 672.014 252.112 668.768C251.522 665.375 251.817 663.015 253.439 661.245C260.078 653.574 261.996 643.69 258.75 632.773C257.275 627.905 257.422 626.725 260.225 623.184C262.733 620.087 263.323 617.284 263.323 609.318V599.286H310.235C348.737 599.286 358.916 598.844 368.062 596.778C396.829 590.287 425.595 567.569 438.577 541.016C441.085 536 444.625 526.559 446.543 520.068C449.936 508.266 449.936 508.119 449.936 415.329C449.936 329.915 449.789 321.653 447.281 312.802C440.347 288.166 425.153 267.219 408.04 258.957C403.172 256.45 399.042 254.089 399.042 253.499C399.042 253.057 402.435 247.598 406.418 241.55C420.432 220.602 424.858 206.44 424.71 182.985C424.563 170.445 423.825 165.282 420.58 155.398C409.958 122.796 380.602 96.5379 348.147 90.7846C336.936 88.7193 323.659 88.2768 317.168 89.4569ZM341.656 116.601C374.553 122.944 397.566 151.268 397.566 185.492C397.566 201.72 393.436 213.964 383.257 229.011C372.636 244.5 369.685 251.139 366.882 264.711L364.374 276.66H353.31H342.246L341.804 265.596C341.066 249.074 342.099 245.828 351.098 236.092C359.949 226.356 362.899 221.487 364.374 213.521C365.26 208.801 364.817 207.62 360.982 203.637C353.606 196.261 346.967 198.327 340.476 209.833C337.968 214.111 334.28 219.127 332.215 221.045L328.527 224.438L323.659 216.029C313.628 198.917 305.809 194.934 297.99 202.9C290.91 209.833 294.007 220.455 307.432 236.092C317.316 247.598 317.906 249.074 317.906 263.973V277.397H306.989C294.745 277.397 295.778 278.578 292.68 263.383C290.614 253.499 286.189 243.615 278.223 231.666C261.258 206.44 256.98 189.033 262.586 167.79C272.174 131.058 305.219 109.667 341.656 116.601ZM262.291 268.546C266.274 268.546 266.274 268.546 266.274 279.168C266.274 287.281 267.159 291.707 269.667 297.313C271.584 301.296 273.65 309.262 274.24 315.015C275.42 327.407 278.37 333.75 285.894 341.126C294.893 349.83 303.006 351.6 332.363 350.862C359.949 350.272 366.145 348.65 374.996 339.208C381.487 332.422 383.995 325.637 385.617 310.737C386.945 299.378 390.486 289.199 393.288 289.199C395.059 289.199 404.795 300.853 407.598 306.459C415.859 322.686 415.859 321.949 416.449 409.723C417.039 501.185 416.449 508.856 407.745 526.559C401.402 539.393 386.798 553.998 373.963 560.193C356.851 568.454 352.868 568.75 265.684 568.75H186.023L184.253 559.898C183.367 555.03 181.892 549.424 181.007 547.359C170.681 522.576 136.604 514.61 116.983 532.312C109.755 538.803 105.919 546.769 104.592 558.276C104.002 562.849 103.117 566.832 102.526 567.274C102.084 567.569 97.0682 566.979 91.7575 565.799C71.1047 561.521 51.337 546.326 42.4858 528.034C33.487 509.299 33.3395 509.004 32.897 417.541C32.6019 342.749 32.7494 333.16 35.1098 324.161C41.4531 298.935 56.9427 280.495 78.9232 271.939C88.512 268.251 133.211 267.366 262.291 268.546ZM360.686 307.934C360.686 313.835 356.113 322.096 351.835 324.161C347.115 326.522 311.562 326.817 307.284 324.456C303.744 322.539 300.203 314.573 300.203 308.377V303.951H330.445H360.686V307.934ZM152.241 553.555C156.519 558.423 157.256 561.226 158.584 578.191C160.207 600.466 157.846 599.139 199.3 599.581C217.887 599.729 233.967 600.319 234.999 600.909C238.097 602.974 237.212 613.448 233.672 616.399C226.591 622.299 224.821 632.921 230.279 637.494C231.459 638.379 232.344 641.772 232.344 644.87C232.344 649.443 231.459 651.066 227.771 653.721C221.87 657.999 220.542 661.687 222.903 669.211C224.525 674.521 224.378 675.849 222.165 679.685C216.854 688.241 195.759 696.354 178.794 696.354C169.796 696.354 154.453 692.961 147.815 689.421C119.639 674.816 111.525 642.215 125.835 599.729C129.67 588.075 132.03 577.896 132.768 569.93C133.948 555.325 136.899 550.31 144.422 550.31C147.52 550.31 150.323 551.49 152.241 553.555Z" fill="currentColor"/>
        <path d="M142.209 373.728C124.212 380.514 113 394.233 110.64 412.526C109.902 417.984 110.197 421.23 111.968 424.475C114.623 429.638 116.836 430.818 124.507 430.818C131.588 430.818 134.538 427.72 137.194 417.394C141.472 400.872 156.666 394.381 167.878 404.117C171.418 407.363 173.484 411.051 175.254 417.394C178.352 428.458 182.335 431.556 191.333 430.376C202.25 428.901 205.495 419.459 200.627 403.38C195.021 385.235 178.942 373.286 158.141 372.253C151.503 371.958 145.455 372.548 142.209 373.728Z" fill="currentColor"/>
        <path d="M293.565 374.318C282.796 378.006 268.781 392.168 265.684 402.79C260.373 420.935 264.798 430.818 278.075 430.818C283.238 430.818 287.959 426.688 289.287 420.935C292.09 407.805 299.613 399.839 309.202 399.839C320.413 399.839 326.609 405.445 329.855 418.279C332.068 427.13 336.051 430.818 343.279 430.818C347.41 430.818 350.065 429.786 352.868 426.983C356.408 423.442 356.556 422.41 355.966 413.411C354.786 397.184 346.967 385.53 332.363 377.711C320.856 371.515 305.514 370.188 293.565 374.318Z" fill="currentColor"/>
        <path d="M170.681 469.91C161.387 477.728 163.452 487.022 177.909 501.626C187.203 511.215 202.398 519.329 215.822 522.132C240.163 527.147 268.339 519.919 286.631 503.839C300.793 491.152 305.366 478.613 298.138 471.385C290.319 463.714 281.616 465.189 273.65 475.81C268.191 483.039 261.258 488.35 252.259 492.185C243.998 495.726 224.968 495.726 215.084 492.333C206.971 489.53 194.579 479.498 191.186 473.155C187.203 465.632 177.467 464.156 170.681 469.91Z" fill="currentColor"/>
      </svg>
    `;

    const messageContent = document.createElement("div");
    messageContent.className = "message-content";

    messageDiv.appendChild(avatar);
    messageDiv.appendChild(messageContent);
  }

  chatArea.appendChild(messageDiv);

  // Auto-scroll to bottom with better timing
  setTimeout(() => {
    // Always scroll for the first message (when input moves from center to bottom)
    const inputArea = document.getElementById("inputArea");
    const isFirstMessage =
      inputArea && inputArea.classList.contains("centered");

    if (isFirstMessage || typeof autoScrollToBottom === "function") {
      if (isFirstMessage) {
        // Force scroll for first message
        chatArea.scrollTop = chatArea.scrollHeight;
      } else {
        autoScrollToBottom();
      }
    } else {
      chatArea.scrollTop = chatArea.scrollHeight;
    }
  }, 50); // Small delay to ensure DOM is updated

  return messageDiv.querySelector(".message-content");
}

// Async function to show a message with word-by-word animation
async function showMessage(content, delay = 70) {
  const messageElement = createMessageContainer(false);
  return animateWordsIn(messageElement, content, delay);
}

// Async function to show a title with word-by-word animation
async function showTitle(content, className = "news-headline", delay = 70) {
  return new Promise(async (resolve) => {
    const titleDiv = document.createElement("div");
    titleDiv.className = className;

    const lastMessage = document.querySelector(
      ".message:last-child .message-content"
    );
    lastMessage.appendChild(titleDiv);

    await animateWordsIn(titleDiv, content, delay);
    resolve();
  });
}

// Async function to show a link with word-by-word animation
async function showLink(text, url, delay = 70) {
  return new Promise(async (resolve) => {
    const linkElement = document.createElement("a");
    linkElement.className = "source-link";
    linkElement.onclick = () => openSource(url);

    const lastMessage = document.querySelector(
      ".message:last-child .message-content"
    );
    lastMessage.appendChild(linkElement);

    await animateWordsIn(linkElement, text, delay);
    resolve();
  });
}

// Async function to show content with word-by-word animation
async function showContent(content, className = "news-content", delay = 70) {
  return new Promise(async (resolve) => {
    const contentDiv = document.createElement("div");
    contentDiv.className = className;

    const lastMessage = document.querySelector(
      ".message:last-child .message-content"
    );
    lastMessage.appendChild(contentDiv);

    await animateWordsIn(contentDiv, content, delay);
    resolve();
  });
}

// Legacy function for backward compatibility
function addMessage(content, isUser = false) {
  const chatArea = document.getElementById("chatArea");
  const messageDiv = document.createElement("div");
  messageDiv.className = `message ${isUser ? "user-message" : "ai-message"}`;

  if (isUser) {
    const messageContent = document.createElement("div");
    messageContent.className = "message-content";
    messageContent.innerHTML = content;

    const avatar = document.createElement("div");
    avatar.className = "avatar user-avatar";
    avatar.textContent = "You";

    messageDiv.appendChild(messageContent);
    messageDiv.appendChild(avatar);
  } else {
    const avatar = document.createElement("div");
    avatar.className = "avatar ai-avatar";
    avatar.innerHTML = `
      <svg class="face-normal" width="407" height="437" viewBox="0 0 407 437" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M96.4 0.8268C51.4667 8.56013 14.9333 41.6268 3.06667 85.0935C0 96.1601 0 96.5601 0 188.827C0 274.56 0.133333 282.16 2.4 290.027C12.8 326.427 38.5333 354.027 75.0667 368.027L84.6667 371.76V390.96C84.6667 414.827 86 420.693 93.2 428.16C102 437.36 112.8 438.827 124.8 432.827C127.467 431.36 138.8 421.76 150 411.227C161.2 400.693 174.267 388.56 179.067 384.16L187.867 376.16L248.533 375.36C318.267 374.56 319.6 374.293 344 362.293C372.8 348.027 393.467 323.76 402.933 293.493L406.667 281.493V188.827C406.667 96.9601 406.667 96.0268 403.733 85.8935C398 66.1601 390.267 52.2935 376.933 37.8935C362.4 22.2935 340.8 9.36013 318.667 3.2268C308.133 0.293467 307.2 0.160133 205.333 0.0268002C148.933 -0.106533 99.8667 0.293467 96.4 0.8268ZM308 33.2268C313.2 34.4268 322.4 37.8935 328.667 40.9601C344 48.5601 359.333 63.6268 366.533 78.1601C375.067 95.6268 375.333 99.2268 375.333 190.027C375.333 266.427 375.2 271.627 372.667 281.36C368.8 296.427 362.933 306.693 351.333 318.293C340.933 328.827 331.6 334.96 318.4 339.76C310.933 342.56 308.267 342.693 246 343.493C165.333 344.293 176.533 340.827 139.2 377.627C127.867 388.96 118 397.76 117.6 397.227C117.067 396.827 116.667 385.76 116.667 372.827C116.667 356.16 116.133 348.693 115.067 347.093C114 345.76 108.267 343.893 100 342.293C80.6667 338.293 69.2 332.293 55.8667 318.96C47.8667 310.96 43.8667 305.627 40.1333 298.16C31.3333 279.893 31.2 278.693 31.6 182.96C32 97.6268 32 97.4935 35.0667 88.8268C40 75.2268 47.7333 63.3601 57.8667 53.8935C71.7333 40.9601 86.6667 34.0268 106 31.3601C110 30.8268 155.067 30.5601 206 30.6935C286.667 30.9601 299.867 31.3601 308 33.2268Z" fill="currentColor"/>
        <path d="M122.667 146.027C104.133 154.56 100.4 178.027 115.333 192.56C124.933 201.76 142.4 201.76 152.4 192.427C164 181.627 163.333 158.827 151.2 149.893C142.133 143.227 131.867 141.76 122.667 146.027Z" fill="currentColor"/>
        <path d="M275.333 145.626C264.933 150.159 259.333 159.093 259.333 171.493C259.333 193.493 280.4 206.159 300.133 195.893C310.4 190.559 316.533 174.559 312.667 162.826C307.733 147.893 289.6 139.493 275.333 145.626Z" fill="currentColor"/>
        <path d="M157.867 225.494C149.067 230.294 150.267 239.627 161.467 251.494C174.267 265.227 189.6 271.494 210 271.494C229.733 271.494 244.133 266.027 257.067 253.494C269.467 241.494 271.6 234.161 264.8 227.361C258.533 221.094 254.267 222.027 244 231.494C233.2 241.627 225.733 244.961 212.667 245.761C198.533 246.694 189.733 243.227 177.733 232.027C168.133 222.961 164.667 221.761 157.867 225.494Z" fill="currentColor"/>
      </svg>
      <svg class="face-thinking" width="428" height="471" viewBox="0 0 428 471" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M92.4 2.09958C45.8667 10.4996 9.6 45.5662 2 89.2996C0.4 98.3663 0 117.166 0 188.766V277.033L3.33333 290.1C8.26667 309.833 20.9333 331.966 34.2667 344.233C50.4 359.033 67.4667 368.1 88.5333 372.766C91.8667 373.433 92.1333 373.966 91.3333 377.166C90.8 379.166 90.1333 387.7 89.7333 396.1C89.2 409.433 89.4667 412.5 92 419.966C104.4 456.766 145.067 477.7 186.8 468.9C207.733 464.366 228 449.166 236.933 431.166C241.467 422.1 242 419.833 242.4 408.233L242.933 395.433L250.533 385.566C254.667 380.1 258.4 375.033 258.933 374.233C259.6 373.166 271.067 372.766 295.6 372.766C337.333 372.766 343.467 371.7 364.667 361.433C393.867 347.3 414.267 323.166 424.133 290.766C427.2 280.766 427.2 280.366 427.733 187.966C428.133 87.4329 428 85.8329 420.933 68.0996C415.467 54.6329 409.2 45.2996 398 34.0996C380.267 16.2329 361.467 6.23291 337.733 2.09958C322.133 -0.700424 107.467 -0.700424 92.4 2.09958ZM337.333 34.6329C362.133 41.4329 384.133 62.4996 392.133 86.8996L395.333 96.7663V185.433V274.1L391.467 285.966C382.667 312.766 360.4 333.033 332.533 339.566C324.933 341.3 316.4 341.566 282 341.166L264 340.9C264 340.9 264.5 334.9 254.5 326.5C244.5 318.1 214.133 330.233 201.067 333.566C185.733 337.566 185.333 337.033 184 319.566C182.8 304.766 179.6 297.566 171.333 291.833C160.4 284.1 138.933 284.366 128.133 292.1C120 297.966 116.8 303.433 110.667 321.833C107.467 331.166 104.267 339.7 103.467 340.766C102.133 342.5 100.8 342.5 93.2 340.9C77.4667 337.566 59.7333 326.233 49.7333 313.3C42.1333 303.433 35.0667 287.833 33.3333 277.433C32.5333 272.233 32 235.966 32 185.433C32 114.766 32.2667 100.766 34 94.0996C42 63.2996 66.6667 39.5662 96.4 34.0996C109.733 31.5662 328.267 32.0996 337.333 34.6329ZM156.533 311.166C158.933 314.366 159.467 317.433 160 330.766C160.8 349.033 162.133 352.1 172 357.033C179.2 360.766 188.8 361.033 200.8 357.833C209.2 355.566 230.567 342.259 239 345C244.333 346.733 246 351.366 242.933 357.033C239.867 362.7 237.6 366.366 237.6 366.366L230 374.9C218.4 387.833 217.333 389.966 217.333 401.433C217.2 417.833 212.533 426.633 199.733 435.166C189.067 442.1 179.333 444.633 164.8 443.7C149.067 442.9 139.6 439.3 130.133 430.633C121.867 423.166 118 415.966 115.867 404.9C114.133 395.033 115.333 389.033 126.267 355.433C138.4 318.1 140.133 313.7 143.067 309.966C146.533 305.433 152.667 305.966 156.533 311.166Z" fill="currentColor"/>
        <path d="M336.667 141.166C333.733 142.499 319.333 149.566 304.667 157.033C281.6 168.633 277.6 171.166 275.467 175.033C272.667 180.233 273.2 184.766 276.933 189.166C280.4 193.033 335.6 221.699 341.333 222.366C352 223.833 358.4 210.366 350.933 202.366C349.333 200.633 339.867 195.299 330 190.633C320.133 185.966 312.133 181.833 312 181.433C312 181.033 320.133 176.633 330 171.699C339.867 166.766 349.733 161.166 352 159.299C357.6 154.499 357.467 149.299 351.467 143.299C346.4 138.233 344.267 137.966 336.667 141.166Z" fill="currentColor"/>
        <path d="M94.5333 143.967C90.2666 148.233 89.6 153.3 92.5333 158.633C93.7333 160.9 101.067 165.3 114.8 172.1C126 177.7 135.333 182.9 135.6 183.567C135.867 184.233 127.6 189.033 117.2 194.1C98 203.567 93.3333 207.3 93.3333 213.033C93.3333 217.167 96.6666 223.567 99.3333 224.633C106 227.167 111.333 225.3 141.867 209.433C166.133 196.9 173.333 192.5 175.2 189.433C178 184.5 177.2 178.9 172.933 175.033C168 170.5 106.533 140.1 102.267 140.1C99.8666 140.1 97.0666 141.433 94.5333 143.967Z" fill="currentColor"/>
        <path d="M212.667 194.634C195.867 198.767 185.867 215.034 195.467 222.634C200.4 226.5 202.4 226.1 207.2 220.634C211.867 215.3 219.2 213.434 225.733 215.967C230.8 217.967 230.267 221.3 224 227.434C213.867 237.434 213.867 248.367 224.133 255.567C231.333 260.5 232.667 263.167 229.333 266.1C226.533 268.634 219.2 269.3 211.6 267.567C206.667 266.5 206.667 266.5 203.867 272.634C202.4 276.1 201.333 279.834 201.6 281.034C202.8 287.034 221.333 291.3 232.8 288.234C247.867 284.1 258.133 269.167 254.667 256.234C253.333 251.434 245.6 242.634 241.333 241.167C240.267 240.9 242.267 237.967 246.533 233.434C258.4 221.167 259.067 210.767 248.533 201.567C240.267 194.367 225.733 191.567 212.667 194.634Z" fill="currentColor"/>
      </svg>
      <svg class="face-done" width="461" height="724" viewBox="0 0 461 724" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M321.741 3.74734L317.906 7.28783V31.7762V56.412L322.331 60.8376C326.314 64.6731 327.642 65.2632 332.362 64.5256C335.608 63.9355 339.148 62.0178 341.214 59.805C344.312 56.117 344.459 54.6418 344.459 32.3662V8.61551L340.181 4.33742C334.575 -1.26834 327.347 -1.41586 321.741 3.74734Z" fill="currentColor"/>
        <path d="M206.381 56.1159C201.66 58.0337 198.414 63.492 198.414 69.2452C198.414 73.6708 200.332 76.1787 213.757 89.898C228.509 104.65 229.541 105.535 235.294 105.535C243.261 105.535 248.571 99.9294 248.571 91.8158C248.571 86.9476 247.096 85.0299 232.639 70.5729C216.264 54.1982 214.052 53.018 206.381 56.1159Z" fill="currentColor"/>
        <path d="M441.085 57.445C438.724 58.9202 430.906 66.1487 423.825 73.3772C411.876 85.6214 410.843 87.2441 410.843 92.5548C410.843 99.4882 415.121 104.209 422.35 105.684C428.546 106.864 431.939 104.651 448.166 88.4242C460.115 76.3276 461 74.9999 461 69.3942C461 64.526 460.115 62.3132 456.722 58.9202C451.706 53.9045 447.281 53.462 441.085 57.445Z" fill="currentColor"/>
        <path d="M317.168 89.4569C315.545 89.752 310.53 90.7846 306.104 91.6697C291.352 94.6201 274.387 103.914 262.586 115.716C243.408 134.893 233.819 157.759 233.819 184.312C233.819 200.835 236.327 211.751 243.261 225.913L248.276 236.092H167.14C77.448 236.092 77.5955 236.092 57.5328 245.681C38.7978 254.679 19.9152 273.119 10.6214 291.412C8.55616 295.542 5.31072 303.804 3.39296 309.852L0 320.916V416.804V512.692L3.98304 525.231C10.9165 546.326 20.6528 561.226 37.4701 575.83C48.3866 585.272 69.3344 595.598 83.0538 598.106C88.9546 599.286 94.1178 600.466 94.4128 600.761C94.7079 601.056 94.1178 604.892 92.9376 609.318C87.9219 627.905 88.9546 655.049 95.1504 671.719C104.002 695.027 125.392 713.762 151.208 720.843C164.19 724.383 191.038 724.383 204.315 720.843C227.476 714.647 244.736 700.485 250.046 683.52C251.964 677.177 252.702 672.014 252.112 668.768C251.522 665.375 251.817 663.015 253.439 661.245C260.078 653.574 261.996 643.69 258.75 632.773C257.275 627.905 257.422 626.725 260.225 623.184C262.733 620.087 263.323 617.284 263.323 609.318V599.286H310.235C348.737 599.286 358.916 598.844 368.062 596.778C396.829 590.287 425.595 567.569 438.577 541.016C441.085 536 444.625 526.559 446.543 520.068C449.936 508.266 449.936 508.119 449.936 415.329C449.936 329.915 449.789 321.653 447.281 312.802C440.347 288.166 425.153 267.219 408.04 258.957C403.172 256.45 399.042 254.089 399.042 253.499C399.042 253.057 402.435 247.598 406.418 241.55C420.432 220.602 424.858 206.44 424.71 182.985C424.563 170.445 423.825 165.282 420.58 155.398C409.958 122.796 380.602 96.5379 348.147 90.7846C336.936 88.7193 323.659 88.2768 317.168 89.4569ZM341.656 116.601C374.553 122.944 397.566 151.268 397.566 185.492C397.566 201.72 393.436 213.964 383.257 229.011C372.636 244.5 369.685 251.139 366.882 264.711L364.374 276.66H353.31H342.246L341.804 265.596C341.066 249.074 342.099 245.828 351.098 236.092C359.949 226.356 362.899 221.487 364.374 213.521C365.26 208.801 364.817 207.62 360.982 203.637C353.606 196.261 346.967 198.327 340.476 209.833C337.968 214.111 334.28 219.127 332.215 221.045L328.527 224.438L323.659 216.029C313.628 198.917 305.809 194.934 297.99 202.9C290.91 209.833 294.007 220.455 307.432 236.092C317.316 247.598 317.906 249.074 317.906 263.973V277.397H306.989C294.745 277.397 295.778 278.578 292.68 263.383C290.614 253.499 286.189 243.615 278.223 231.666C261.258 206.44 256.98 189.033 262.586 167.79C272.174 131.058 305.219 109.667 341.656 116.601ZM262.291 268.546C266.274 268.546 266.274 268.546 266.274 279.168C266.274 287.281 267.159 291.707 269.667 297.313C271.584 301.296 273.65 309.262 274.24 315.015C275.42 327.407 278.37 333.75 285.894 341.126C294.893 349.83 303.006 351.6 332.363 350.862C359.949 350.272 366.145 348.65 374.996 339.208C381.487 332.422 383.995 325.637 385.617 310.737C386.945 299.378 390.486 289.199 393.288 289.199C395.059 289.199 404.795 300.853 407.598 306.459C415.859 322.686 415.859 321.949 416.449 409.723C417.039 501.185 416.449 508.856 407.745 526.559C401.402 539.393 386.798 553.998 373.963 560.193C356.851 568.454 352.868 568.75 265.684 568.75H186.023L184.253 559.898C183.367 555.03 181.892 549.424 181.007 547.359C170.681 522.576 136.604 514.61 116.983 532.312C109.755 538.803 105.919 546.769 104.592 558.276C104.002 562.849 103.117 566.832 102.526 567.274C102.084 567.569 97.0682 566.979 91.7575 565.799C71.1047 561.521 51.337 546.326 42.4858 528.034C33.487 509.299 33.3395 509.004 32.897 417.541C32.6019 342.749 32.7494 333.16 35.1098 324.161C41.4531 298.935 56.9427 280.495 78.9232 271.939C88.512 268.251 133.211 267.366 262.291 268.546ZM360.686 307.934C360.686 313.835 356.113 322.096 351.835 324.161C347.115 326.522 311.562 326.817 307.284 324.456C303.744 322.539 300.203 314.573 300.203 308.377V303.951H330.445H360.686V307.934ZM152.241 553.555C156.519 558.423 157.256 561.226 158.584 578.191C160.207 600.466 157.846 599.139 199.3 599.581C217.887 599.729 233.967 600.319 234.999 600.909C238.097 602.974 237.212 613.448 233.672 616.399C226.591 622.299 224.821 632.921 230.279 637.494C231.459 638.379 232.344 641.772 232.344 644.87C232.344 649.443 231.459 651.066 227.771 653.721C221.87 657.999 220.542 661.687 222.903 669.211C224.525 674.521 224.378 675.849 222.165 679.685C216.854 688.241 195.759 696.354 178.794 696.354C169.796 696.354 154.453 692.961 147.815 689.421C119.639 674.816 111.525 642.215 125.835 599.729C129.67 588.075 132.03 577.896 132.768 569.93C133.948 555.325 136.899 550.31 144.422 550.31C147.52 550.31 150.323 551.49 152.241 553.555Z" fill="currentColor"/>
        <path d="M142.209 373.728C124.212 380.514 113 394.233 110.64 412.526C109.902 417.984 110.197 421.23 111.968 424.475C114.623 429.638 116.836 430.818 124.507 430.818C131.588 430.818 134.538 427.72 137.194 417.394C141.472 400.872 156.666 394.381 167.878 404.117C171.418 407.363 173.484 411.051 175.254 417.394C178.352 428.458 182.335 431.556 191.333 430.376C202.25 428.901 205.495 419.459 200.627 403.38C195.021 385.235 178.942 373.286 158.141 372.253C151.503 371.958 145.455 372.548 142.209 373.728Z" fill="currentColor"/>
        <path d="M293.565 374.318C282.796 378.006 268.781 392.168 265.684 402.79C260.373 420.935 264.798 430.818 278.075 430.818C283.238 430.818 287.959 426.688 289.287 420.935C292.09 407.805 299.613 399.839 309.202 399.839C320.413 399.839 326.609 405.445 329.855 418.279C332.068 427.13 336.051 430.818 343.279 430.818C347.41 430.818 350.065 429.786 352.868 426.983C356.408 423.442 356.556 422.41 355.966 413.411C354.786 397.184 346.967 385.53 332.363 377.711C320.856 371.515 305.514 370.188 293.565 374.318Z" fill="currentColor"/>
        <path d="M170.681 469.91C161.387 477.728 163.452 487.022 177.909 501.626C187.203 511.215 202.398 519.329 215.822 522.132C240.163 527.147 268.339 519.919 286.631 503.839C300.793 491.152 305.366 478.613 298.138 471.385C290.319 463.714 281.616 465.189 273.65 475.81C268.191 483.039 261.258 488.35 252.259 492.185C243.998 495.726 224.968 495.726 215.084 492.333C206.971 489.53 194.579 479.498 191.186 473.155C187.203 465.632 177.467 464.156 170.681 469.91Z" fill="currentColor"/>
      </svg>
    `;

    const messageContent = document.createElement("div");
    messageContent.className = "message-content";
    messageContent.innerHTML = content;

    messageDiv.appendChild(avatar);
    messageDiv.appendChild(messageContent);
  }

  chatArea.appendChild(messageDiv);
  chatArea.scrollTop = chatArea.scrollHeight;

  return messageDiv.querySelector(".message-content");
}
